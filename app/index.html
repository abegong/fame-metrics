<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <link rel="stylesheet" href="style.css" type="text/css">
    <script type="text/javascript" src="jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="jQueryRotate.js"></script>
    <script type="text/javascript" src="jquery.color.js"></script>
    <script type='text/javascript' src='data.js'></script>
    <!--<script type='text/javascript' src='https://cdn.firebase.com/js/client/1.0.11/firebase.js'></script>-->
    <script>
//var fb = new Firebase('https://fame-meter.firebaseio.com/celebs');
// myRootRef.set('Hello World!');
// fb.on('value', function(snapshot) {
//   console.log(snapshot.val());
//   alert('fredâ€™s first name is ' + snapshot.val());
// });
var choose = function(A){
    return A[Math.floor(Math.random()*A.length)];
};

var mock_fb = {
    get_question : function(){
        return {
            id: Math.floor(Math.random()*10000),
            name: choose(names),
            right_answer: {id: 1, val: choose(tags)},
            wrong_answers: [
                {id: 2, val: choose(tags)},
                {id: 3, val: choose(tags)},
                {id: 4, val: choose(tags)},
                {id: 5, val: choose(tags)}
            ]
        }
    }
};

var mclbiq = {
    session_name : null,
    begin_quiz : function(){
        mclbiq.set_session_name();
        mclbiq.start_timer();
        mclbiq.next_question(mock_fb.get_question());

    //            $(window).bind('beforeunload', function(){
    //                return 'Are you sure you want to quit?\nIf you go, make sure to write down this code: '+session_name+' so that you can get your score later.'
    //            });
    },
    set_session_name : function(){
        mclbiq.session_name = choose(famous_adjs)+'-'+choose(famous_nouns)+'-'+Math.floor(1000+9000*Math.random());
        $(".session-name").html(mclbiq.session_name);
    },
    start_timer : function(){
        var start = new Date().getTime();
        window.setInterval(function()
        {
            var time = new Date().getTime() - start;

            var totalSec = Math.floor(time / 1000);
            var minutes = parseInt( totalSec / 60 );// % 60;
            var seconds = totalSec % 60;

            var result = (minutes) + ":" + (seconds  < 10 ? "0" + seconds : seconds);
            $("#timer").html(result);
        }, 100);
    },
    create_basic_question : function(j){
        //Create q object
        var new_q = $("#proto_q")
            .clone()
            .attr("id","none")
            .prependTo($("#main"));

        //Append data in the proper fields
        $(".qhead", new_q).append('<h2 class="title">Who is <span class="celeb_name"><b>Harrison Ford</b></span>?</h2>');
        $(".celeb_name", new_q).html(j.name);
        
        $(".qbody", new_q).append('<div class="qanswer" data-correct=1><input type="radio" name="q'+j.id+'" value="'+j.right_answer.id+'"><span>'+j.right_answer.val+'</span></div>');
        for( a in j.wrong_answers ){
            $(".qbody", new_q).append('<div class="qanswer" data-correct=0><input type="radio" name="q'+j.id+'" value="'+j.wrong_answers[a].id+'"><span>'+j.wrong_answers[a].val+'</span></div>');
        }

        //Set up events
        $(".qanswer", new_q)
            .mouseover(function(){$(this).css("background-color","#ddd")})
            .mouseout(function(){$(this).css("background-color","#fff")})
            .click(mclbiq.answer_question)
            .detach()
            .sort( function(){ return ( Math.round( Math.random() ) - 0.5 ) } )
            .appendTo($(".qbody", new_q));
        
        new_q.slideDown(500);
    },
    create_bkwd_question : function(j){
        //Create q object
        var new_q = $("#proto_q")
            .clone()
            .attr("id","none")
            .prependTo($("#main"));

        //Append data in the proper fields
        $(".qhead", new_q).append('<h2 class="title">Which of these does <i><b>not</b></i> describe <b>'+j.name+'</b>?</h2>');
        
        $(".qbody", new_q).append('<div class="qanswer" data-correct=1><input type="radio" name="q'+j.id+'" value="'+j.right_answer.id+'"><span>'+j.right_answer.val+'</span></div>');
        for( a in j.wrong_answers ){
            $(".qbody", new_q).append('<div class="qanswer" data-correct=0><input type="radio" name="q'+j.id+'" value="'+j.wrong_answers[a].id+'"><span>'+j.wrong_answers[a].val+'</span></div>');
        }

        //Set up events
        $(".qanswer", new_q)
            .mouseover(function(){$(this).css("background-color","#ddd")})
            .mouseout(function(){$(this).css("background-color","#fff")})
            .click(mclbiq.answer_question)
            .detach()
            .sort( function(){ return ( Math.round( Math.random() ) - 0.5 ) } )
            .appendTo($(".qbody", new_q));
        
        new_q.slideDown(500);
    },
    create_name_something_question : function(j){
        //Create q object
        var new_q = $("#proto_q")
            .clone()
            .attr("id","none")
            .prependTo($("#main"));

        //Append data in the proper fields
        $(".qhead", new_q).append('<h2 class="title">Name something unique and noteworthy about <b>'+j.name+'</b>.</h2>');
        $(".qbody", new_q).append('<textarea rows=3 name="q'+j.id+'"></textarea><div class="submit">Done</div>');

        //Set up events
        //...
        
        new_q.slideDown(500);
    },
    create_most_famous_question : function(j){
        //Create q object
        var new_q = $("#proto_q")
            .clone()
            .attr("id","none")
            .prependTo($("#main"));

        //Append data in the proper fields
        $(".qhead", new_q).append('<h2 class="title">Which of these celebrities do you think is the <i><b>most</b></i> famous?</h2>');
        
        for( a in j.wrong_answers ){
            $(".qbody", new_q).append('<div class="qanswer" data-correct=0><input type="radio" name="q'+j.id+'" value="'+j.wrong_answers[a].id+'"><span>'+j.wrong_answers[a].val+'</span></div>');
        }

        //Set up events
        $(".qanswer", new_q)
            .mouseover(function(){$(this).css("background-color","#ddd")})
            .mouseout(function(){$(this).css("background-color","#fff")})
            .click(mclbiq.answer_question)
            .detach()
            .sort( function(){ return ( Math.round( Math.random() ) - 0.5 ) } )
            .appendTo($(".qbody", new_q));
        
        new_q.slideDown(500);
    },
    create_pick_topic_question : function(j){
        //Create q object
        var new_q = $("#proto_q")
            .clone()
            .attr("id","none")
            .prependTo($("#main"));

        //Append data in the proper fields
        $(".qhead", new_q).append('<h2 class="title">Pick a topic for your next set of questions</h2>');
        
        var lists = ["Sports", "Science", "Movies", "Politics", "History"];
        for( a in lists ){
            $(".qbody", new_q).append('<div class="qanswer" data-correct=0><input type="radio" name="q'+j.id+'" value="'+lists[a]+'"><span>'+lists[a]+'</span></div>');
        }

        //Set up events
        $(".qanswer", new_q)
            .mouseover(function(){$(this).css("background-color","#ddd")})
            .mouseout(function(){$(this).css("background-color","#fff")})
            .click(mclbiq.answer_question)
            .detach()
            .sort( function(){ return ( Math.round( Math.random() ) - 0.5 ) } )
            .appendTo($(".qbody", new_q));
        
        new_q.slideDown(500);
    },
    next_question : function(j){
        mclbiq.create_basic_question(j);
//        mclbiq.create_name_something_question(j);
//        mclbiq.create_bkwd_question(j);
//        mclbiq.create_most_famous_question(j);
//        mclbiq.create_pick_topic_question(j);
    },
    answer_question : function(){
        $("input", this).attr("checked", true);

        var parent = $(this).closest(".question");
        if($(this).attr("data-correct")==1){
            var bgcolor = "#cfc";
            $("#score-num").html( parseInt($("#score-num").html())+1 );
        } else {
            var bgcolor = "#fcc";
        }
        $("#score-denom").html( parseInt($("#score-denom").html())+1 );

        $(".qanswer", parent)
            .off('mouseover')
            .off('mouseout')
            .off('click')
            .css("cursor", "default")
            .not($(this))
                .animate(
                    {"background-color": "transparent"},
                    10
                );

        //Bold the correct answer
        $(".qanswer[data-correct=1]", parent).css("font-weight","Bold");

        //Fade out the radio buttons 
        $("input[type=radio]", parent)
            .css('cursor', 'default')
            .animate({'opacity': 0.01});

        //Change the background color to red or green, and bring in the next question
        parent.animate(
            {'background-color': bgcolor},
            function(){
                mclbiq.next_question(mock_fb.get_question());
            }
        );


    }
}

$().ready(mclbiq.begin_quiz);
    </script>
</head>
<body>
<div id="header">
    <span id="head-title"><b>My Celebrity IQ</b></span>
    <span id="head-right"><a href="feedback/"> Feedback </a>| <a href="about/">About</a> </span>
</div>
<div id="score-box">
    <span id="score-num">0</span> of <span id="score-denom">0</span> correct<br/>
    <span id="timer">0:00</span><br/>
    <span id="session-name" class="session-name"></span>
</div>
<div id="main">
<form action="" title="">
  <div id="intro_q" class="question">
      <h2><b>Your code: <span class="session-name">famous-bigwig-3024</span></b></h2>
      We don't do logins yet, but we'll remember your game. Write down this code (<span class="session-name">famous-bigwig-3024</span>) so you can get your score later.
  </div>
    
  <div id="proto_q" class="question" style="display:none">
    <div class="qhead"></div>
    <div class="qbody"></div>
<!--
    <div class="qright">
        <h3>Correct!</h3>
        <div class="qbettername">
            <label class="title">Can you think of a better description for <b class="celeb_name">Harrison Ford</b>?</label>
            <input type="text" name="field1">
        </div>
    </div>
    <div class="qwrong"><h3>Nope.</h3></div>
-->
  </div>
</form>
</div>
</body>
</html>